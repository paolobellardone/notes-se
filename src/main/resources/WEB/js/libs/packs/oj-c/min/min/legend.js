define("oj-c/hooks/UNSAFE_useVisBusyState/useVisBusyState",["require","exports","preact/hooks","ojs/ojcontext"],(function(require,e,t,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.useVisBusyState=void 0,e.useVisBusyState=function(e,n){return(0,t.useCallback)((()=>{if(e.current){return i.getContext(e.current).getBusyContext().addBusyState({description:n})}return()=>{}}),[n,e])}})),define("oj-c/legend-item/legend-item",["require","exports","@oracle/oraclejet-preact/translationBundle","ojs/ojvcomponent"],(function(require,e,t,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.LegendItem=e.LegendItemDefaults=void 0,e.LegendItemDefaults={markerShape:"square",symbolType:"marker",borderColor:"",categories:[],lineStyle:"solid",drilling:"inherit"},e.LegendItem=(0,i.registerCustomElement)("oj-c-legend-item",(({markerShape:t=e.LegendItemDefaults.markerShape,symbolType:i=e.LegendItemDefaults.symbolType,borderColor:n=e.LegendItemDefaults.borderColor,categories:o=e.LegendItemDefaults.categories,lineStyle:a=e.LegendItemDefaults.lineStyle,drilling:r=e.LegendItemDefaults.drilling,...s})=>null),"LegendItem",{properties:{text:{type:"string"},categories:{type:"Array<string>"},symbolType:{type:"string",enumValues:["marker","image","line","lineWithMarker"]},source:{type:"string"},color:{type:"string"},borderColor:{type:"string"},lineStyle:{type:"string",enumValues:["dashed","solid","dotted"]},lineWidth:{type:"number"},markerShape:{type:"string",enumValues:["square","circle","ellipse","diamond","human","plus","star","triangleDown","triangleUp","rectangle"]},markerColor:{type:"string"},shortDesc:{type:"string"},drilling:{type:"string",enumValues:["inherit","off","on"]}}},{markerShape:"square",symbolType:"marker",borderColor:"",categories:[],lineStyle:"solid",drilling:"inherit"},{"@oracle/oraclejet-preact":t.default})})),define("oj-c/legend-section/legend-section",["require","exports","@oracle/oraclejet-preact/translationBundle","ojs/ojvcomponent"],(function(require,e,t,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.LegendSection=e.LegendSectionDefaults=void 0,e.LegendSectionDefaults={text:""},e.LegendSection=(0,i.registerCustomElement)("oj-c-legend-section",(({text:t=e.LegendSectionDefaults.text,...i})=>null),"LegendSection",{properties:{text:{type:"string"}}},{text:""},{"@oracle/oraclejet-preact":t.default})})),define("oj-c/legend/utils",["require","exports","../legend-item/legend-item","../legend-section/legend-section"],(function(require,e,t,i){"use strict";function n(e,i,n,a,r,s){const d={...t.LegendItemDefaults,...e};return{borderColor:d.borderColor,lineWidth:d.lineWidth,markerColor:d.markerColor||d.color||void 0,lineColor:d.color||void 0,markerShape:"line"!==d.symbolType?d.markerShape:"none",lineStyle:"marker"!==d.symbolType?d.lineStyle:"none","aria-label":[d.shortDesc,a].filter(Boolean).join(" ")||void 0,datatip:d.shortDesc,source:d.source,text:d.text,actionable:"on"===s?"inherit":o(r,d.drilling),id:`${i};${n}`}}Object.defineProperty(e,"__esModule",{value:!0}),e.isLegendItemDrillable=e.getDefaultSymbolDims=e.isTreeDataProvider=e.transformSection=e.transformItem=e.parseItemId=e.isLegendInteractive=e.getSectionStyles=e.getTextStyles=void 0,e.getTextStyles=function(e){return{textFontStyle:e?.fontStyle,textFontSize:e?.fontSize,textFontColor:e?.color,textFontWeight:e?.fontWeight,textDecoration:e?.textDecoration,textFontFamily:e?.fontFamily}},e.getSectionStyles=function(e){return{sectionTitleColor:e?.color,sectionTitleFontFamily:e?.fontFamily,sectionTitleFontSize:e?.fontSize,sectionTitleFontStyle:e?.fontStyle,sectionTitleFontWeight:e?.fontWeight,sectionTitleTextDecoration:e?.textDecoration}},e.isLegendInteractive=function(e,t,i,n){return"on"===e||"on"===t||"dim"===i||n},e.parseItemId=function(e){return e.split(";").map((e=>parseInt(e,10)))},e.transformItem=n,e.transformSection=function(e,t,o,a){const r={...i.LegendSectionDefaults,...e};return{items:r.items.map(((e,i)=>n(e,o,i,t,a))),title:r.text||r.title,id:`${o}`}},e.isTreeDataProvider=function(e){return!(!e||!e.getChildDataProvider)};function o(e,t){let i="inherit";return"on"===t||("off"===t?i="off":"on"===e?i="inherit":"off"===e&&(i="off")),i}e.getDefaultSymbolDims=(e,t)=>e||t?e?t?{width:t,height:e}:{width:e,height:e}:{width:t,height:t}:{width:void 0,height:void 0},e.isLegendItemDrillable=o})),define("oj-c/hooks/UNSAFE_useDataProvider/utils",["require","exports"],(function(require,e){"use strict";function t(e,t,i,n){const o=[...n];return e.forEach(((e,n)=>{const a={data:t[n],key:i[n]?.key,metadata:i[n]};e>=0?o.splice(e,0,a):o.push(a)})),o}async function i(e,t){const i=[],n=(await e.fetchByKeys({keys:t})).results;for(const e of t)if(n.has(e)){const t=n.get(e);i.push({...t,key:e})}return i}function n(e,t){return e.has(t)?e.get(t):-1}function o(e,t){const i=[...t];return e.sort(((e,t)=>t-e)),e.forEach((e=>{e<i.length&&i.splice(e,1)})),i}Object.defineProperty(e,"__esModule",{value:!0}),e.getUpdatedItemsFromMutationDetail=void 0,e.getUpdatedItemsFromMutationDetail=async function(e,a,r){const{add:s,remove:d,update:l}=e??{},c=new Map;for(const[e,t]of a.entries())c.set(t.key,e);let u=[...a];return d&&(u=function(e,t,i){const{indexes:a,keys:r}=e;let s=[...t];a?.length?s=o(a,s):r?.size&&(s=function(e,t,i){const a=[];return e.forEach((e=>{const t=n(i,e);-1!==t&&a.push(t)})),o(a,t)}(r,s,i));return s}(d,u,c)),s&&(u=await async function(e,o,a,r){const{addBeforeKeys:s,data:d,indexes:l,keys:c,metadata:u}=e;let g=[...o],h=d||[],p=u||[];if(0===h.length&&c?.size){const e=await i(r,c)??[];h=e.map((e=>e.data)),p=e.map((e=>e.metadata))}0===p.length&&c?.size&&(p=[...c].map((e=>({key:e}))));h.length&&(g=l?.length?t(l,h,p,g):s?.length?function(e,i,o,a){const r=[],s=[];return e.forEach((e=>{r.push(n(a,e)),s.push({key:e})})),t(r,i,s,o)}(s,h,g,a):function(e,i,n){return t(new Array(e.length).fill(-1),e,i,n)}(h,p,g));return g}(s,u,c,r)),l&&(u=await async function(e,t,o,a){const{data:r,indexes:s,keys:d,metadata:l}=e;let c=[...t],u=r||[],g=l||[];if(0===u.length&&d?.size){const e=await i(a,d)??[];u=e.map((e=>e.data)),g=e.map((e=>e.metadata))}0===g.length&&d?.size&&(g=[...d].map((e=>({key:e}))));u.length&&(s?.length?c=function(e,t,i,n){const o=[...n];return e.forEach(((e,n)=>{if(o[e]){const a={data:t[n],key:i[n]?.key,metadata:i[n]};o.splice(e,1,a)}})),o}(s,u,g,c):d?.size&&(c=function(e,t,i,o,a){const r=[...o];return e.forEach((e=>{const o=n(a,e),s={data:t[o],key:i[o]?.key,metadata:i[o]};o>=0&&r.splice(o,1,s)})),r}(d,u,g,c,o)));return c}(l,u,c,r)),u}})),define("oj-c/hooks/UNSAFE_useDataProvider/DataProviderHandler",["require","exports","./utils"],(function(require,e,t){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.DataProviderHandler=void 0;e.DataProviderHandler=class{constructor(e,i,n){this.handleMutateEvent=async e=>{const{detail:i}=e,n=this.addBusyState("updating data from mutation event"),o=await(0,t.getUpdatedItemsFromMutationDetail)(i,this.currentData,this.dataProvider);n?.(),this.currentData=o,this.callback?.onDataUpdated?.(o)},this.handleRefreshEvent=()=>{this._fetchDataAndNotify()},this.addBusyState=i,this.callback=n,this.dataProvider=e,this.currentData=[],e.addEventListener("refresh",this.handleRefreshEvent),e.addEventListener("mutate",this.handleMutateEvent),this._fetchDataAndNotify()}destroy(){this.callback=void 0,this.currentData=[],this.dataProvider.removeEventListener("refresh",this.handleRefreshEvent),this.dataProvider.removeEventListener("mutate",this.handleMutateEvent)}async _fetchData(){const e=[],t=this.dataProvider.fetchFirst({size:-1});for await(const i of t){const t=i.data.map(((e,t)=>({data:e,key:i.metadata[t].key,metadata:i.metadata[t]})));e.push(...t)}return this.currentData=e.slice(),e}async _fetchDataAndNotify(){const e=this.addBusyState("fetching data"),t=await this._fetchData();this.callback?.onDataUpdated?.(t),e()}}})),define("oj-c/hooks/UNSAFE_useDataProvider/useDataProvider",["require","exports","preact/hooks","./DataProviderHandler"],(function(require,e,t,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.useDataProvider=void 0,e.useDataProvider=function({addBusyState:e,data:n}){const[o,a]=(0,t.useState)([]),r=(0,t.useRef)();return(0,t.useEffect)((()=>(void 0!==n&&(r.current=new i.DataProviderHandler(n,e,{onDataUpdated:a})),()=>{r.current?.destroy(),r.current=void 0})),[n,e]),{data:o}}})),define("oj-c/utils/UNSAFE_vizUtils/TemplateHandler",["require","exports","preact/compat"],(function(require,e,t){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.processTemplate=e.processNodeTemplate=void 0;const i=e=>Object.keys(e).reduce(((t,i)=>{if("children"===i)return t;const{prop:n,value:o}=((e,t)=>"__oj_private_do_not_use_value"===e?{prop:"value",value:"symbol"!=typeof t?t:void 0}:"__oj_private_do_not_use_checked"===e?{prop:"checked",value:"symbol"!=typeof t?t:void 0}:{prop:e,value:t})(i,e[i]);return t[(e=>e[0].toLowerCase()!==e[0]?e.toLowerCase().replace(/-./g,(e=>e[1].toUpperCase())):e)(n)]=o,t}),{});e.processNodeTemplate=(e,n,o,a)=>{const r=n(o),s=t.Children.toArray(r).find((e=>{if(e&&e.props)return(e.props?.children?.type||e.type)===a})),d=s?.type===a?s.props:(s?.props?.children).props,l=e.key||e.metadata?.key;return d?{...i(d),key:l,id:l,_itemData:e.data}:{key:l,id:l,_itemData:e.data}};e.processTemplate=(t,i,n,o)=>t.map(((t,a)=>(0,e.processNodeTemplate)(t,i,n(t,a),o)))})),define("oj-c/hooks/UNSAFE_useVizCategories/useVizCategories",["require","exports","@oracle/oraclejet-preact/hooks/UNSAFE_useCategories"],(function(require,e,t){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.useVizCategories=void 0,e.useVizCategories=function(e,i,n,o,a="any",r="all",s,d){const{ids:l,updateCategories:c}=(0,t.useCategories)(e,i,n,a,!1,s),{ids:u,updateCategories:g}=(0,t.useCategories)(e,i,o,r,!0,d);return{hiddenIds:l,updateHidden:c,highlightedIds:u,updateHighlighted:g}}})),define("oj-c/legend/events",["require","exports","./utils"],(function(require,e,t){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.getLegendEventsHandler=void 0;e.getLegendEventsHandler=(e,i,n,o,a,r="off",s,d)=>({itemActionHandler:i=>{e&&n(i.itemId);const[o,l]=(0,t.parseItemId)(i.itemId);"off"!==(0,t.isLegendItemDrillable)(r,s(l,o))&&d?.({id:a((0,t.parseItemId)(i.itemId))})},inputHandler:e=>{i&&o(e.itemId)}})})),define("oj-c/legend/useSectionData",["require","exports","preact/compat","../utils/UNSAFE_vizUtils/TemplateHandler","../hooks/UNSAFE_useDataProvider/useDataProvider","ojs/ojflattenedtreedataproviderview","ojs/ojkeyset"],(function(require,e,t,i,n,o,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.useSectionData=void 0,e.useSectionData=function(e,r,s,d){const l=(0,t.useRef)(e),c=(0,t.useRef)(new o(e,{expanded:new a.AllKeySetImpl}));l.current!=e&&(l.current=e,c.current=new o(l.current,{expanded:new a.AllKeySetImpl}));const{data:u}=(0,n.useDataProvider)({data:c.current,addBusyState:r}),g=[];if(u.length>0){let e;for(const t of u){const n={key:t.metadata?.key,data:t.data,index:t.metadata.indexFromParent};if(0===t?.metadata?.treeDepth){e=t;let o=t.data;const a=[];s&&(o=(0,i.processNodeTemplate)(t,s,n,"oj-c-legend-section")),g.push({...o,items:a})}else{const o={...n,parentKey:t.metadata?.parentKey,parentData:e?.data},a=d?(0,i.processNodeTemplate)(t,d,o,"oj-c-legend-item"):t.data;g[g.length-1].items.push({key:t.metadata?.key,...a})}}}return g}})),define("oj-c/legend/legend",["require","exports","preact/jsx-runtime","@oracle/oraclejet-preact/translationBundle","preact/hooks","@oracle/oraclejet-preact/UNSAFE_Legend","../hooks/UNSAFE_useVisBusyState/useVisBusyState","@oracle/oraclejet-preact/UNSAFE_SectionalLegend","ojs/ojvcomponent","./utils","../hooks/UNSAFE_useDataProvider/useDataProvider","../utils/UNSAFE_vizUtils/TemplateHandler","@oracle/oraclejet-preact/hooks/UNSAFE_useTranslationBundle","preact/compat","../hooks/UNSAFE_useVizCategories/useVizCategories","./events","./useSectionData","css!oj-c/legend/legend-styles.css"],(function(require,e,t,i,n,o,a,r,s,d,l,c,u,g,h,p,m){"use strict";function y({hoverBehavior:e,hideAndShowBehavior:i,hiddenCategories:n,highlightedCategories:a,onHiddenCategoriesChanged:r,onHighlightedCategoriesChanged:s,drilling:m,itemTemplate:y,sectionTemplate:f,textStyle:v,orientation:S,symbolHeight:b,symbolWidth:D,...j}){const{data:_}=(0,l.useDataProvider)({data:j.data?j.data:void 0,addBusyState:j.addBusyState}),k="dim"===e,x="on"===i,C=(0,u.useTranslationBundle)("@oracle/oraclejet-preact"),I=y?(0,c.processTemplate)(_,y,((e,t)=>({data:e.data,key:e.key,index:t})),"oj-c-legend-item"):_.map((e=>e.data)),L=(0,g.useMemo)((()=>I.some((e=>"on"===e.drilling))),[I]),T=(0,g.useMemo)((()=>I.map(((e,t)=>(0,d.transformItem)(e,0,t,"on"===m&&"off"!==e.drilling||"on"===e.drilling?C.vis_drillable():"",m,i)))),[I,m,C]),B=(0,d.isLegendInteractive)(m,i,e,L),P=(0,g.useMemo)((()=>{const e=[];return(x||k)&&I.forEach(((t,i)=>{e.push({id:T[i].id,categories:t.categories||[]})})),e}),[T,I,x,k]),{hiddenIds:E,updateHidden:H,highlightedIds:A,updateHighlighted:F}=(0,h.useVizCategories)(P,(e=>e.categories),n,a,"any","any",r,s),{itemActionHandler:w,inputHandler:M}=(0,p.getLegendEventsHandler)(x,k,H,F,(e=>{const[t,i]=e,n=I[i];return n.categories?.length>0?n.categories:_[i].metadata?.key}),m,(e=>{const t=I[e];return t?.drilling}),j.onOjDrill),U=(0,d.getTextStyles)(v);return 0!==T.length?(0,t.jsx)(o.Legend,{orientation:S,symbolHeight:b,symbolWidth:D,isReadOnly:!B,hideAndShowBehavior:i,hoverBehavior:e,hiddenIds:x?E:void 0,highlightedIds:k?A:void 0,items:T,onItemAction:w,onItemHover:M,onItemFocus:M,...j,...U}):null}function f({hoverBehavior:e,hideAndShowBehavior:i,hiddenCategories:n,highlightedCategories:o,onHiddenCategoriesChanged:a,onHighlightedCategoriesChanged:s,drilling:l,itemTemplate:c,sectionTemplate:y,textStyle:f,sectionTitleStyle:v,orientation:S,symbolHeight:b,symbolWidth:D,data:j,..._}){const k="dim"===e,x="on"===i,C=(0,u.useTranslationBundle)("@oracle/oraclejet-preact"),I=(0,m.useSectionData)(j,_.addBusyState,y,c),L=(0,g.useMemo)((()=>I.some((e=>e.items.some((e=>"on"===e.drilling))))),[I]),T=(0,g.useMemo)((()=>I.map(((e,t)=>(0,d.transformSection)(e,"on"===l?C.vis_drillable():"",t)))),[I,l,C]),B=(0,d.isLegendInteractive)(l,i,e,L),P=(0,g.useMemo)((()=>{const e=[];return(x||k)&&I.forEach(((t,i)=>{t.items.forEach(((t,n)=>{e.push({id:T[i].items[n].id,categories:t.categories||[]})}))})),e}),[I,x,k,T]),{hiddenIds:E,updateHidden:H,highlightedIds:A,updateHighlighted:F}=(0,h.useVizCategories)(P,(e=>e.categories),n,o,"any","any",a,s),{itemActionHandler:w,inputHandler:M}=(0,p.getLegendEventsHandler)(x,k,H,F,(e=>{const[t,i]=e,n=I[t].items[i];return n.categories?n.categories:n.key}),l,((e,t)=>{const i=I[t].items[e];return i?.drilling}),_.onOjDrill),U=(0,d.getTextStyles)(f),V=(0,d.getSectionStyles)(v);return 0!==T.length?(0,t.jsx)(r.SectionalLegend,{sections:T,orientation:S,sectionTitleHAlign:_.sectionTitleHalign,symbolHeight:b,symbolWidth:D,isReadOnly:!B,hideAndShowBehavior:i,hoverBehavior:e,"aria-label":_["aria-label"],"aria-describedBy":_["aria-describedby"],"aria-labelledBy":_["aria-labelledby"],hiddenIds:x?E:void 0,highlightedIds:k?A:void 0,onItemAction:w,onItemHover:M,onItemFocus:M,...U,...V}):null}Object.defineProperty(e,"__esModule",{value:!0}),e.LinearLegend=e.Legend=void 0,e.Legend=(0,s.registerCustomElement)("oj-c-legend",(function({data:e=null,drilling:i="off",halign:o="start",valign:r="top",hiddenCategories:l=[],hideAndShowBehavior:c="off",highlightedCategories:u=[],hoverBehavior:g="none",orientation:h="vertical",symbolHeight:p=0,symbolWidth:m=0,textStyle:v={},sectionTitleStyle:S={},sectionTitleHalign:b="start",...D}){const j=(0,n.useRef)(null),_=(0,a.useVisBusyState)(j,"oj-c-legend"),k=(0,d.isTreeDataProvider)(e),{width:x,height:C}=(0,d.getDefaultSymbolDims)(p,m);return(0,t.jsx)(s.Root,{ref:j,class:`oj-c-legend-${o} oj-c-legend-${r}`,children:k?(0,t.jsx)(f,{data:e,...D,addBusyState:_,drilling:i,hiddenCategories:l,hideAndShowBehavior:c,highlightedCategories:u,hoverBehavior:g,orientation:h,symbolHeight:C,symbolWidth:x,textStyle:v,sectionTitleStyle:S,sectionTitleHalign:b}):(0,t.jsx)(y,{...D,data:e,drilling:i,hiddenCategories:l,hideAndShowBehavior:c,highlightedCategories:u,hoverBehavior:g,orientation:h,symbolHeight:C,symbolWidth:C,addBusyState:_,textStyle:v})})}),"Legend",{properties:{data:{type:"DataProvider|null"},drilling:{type:"string",enumValues:["off","on"]},halign:{type:"string",enumValues:["center","end","start"]},hiddenCategories:{type:"Array<string>",writeback:!0},hideAndShowBehavior:{type:"string",enumValues:["off","on"]},highlightedCategories:{type:"Array<string>",writeback:!0},hoverBehavior:{type:"string",enumValues:["none","dim"]},orientation:{type:"string",enumValues:["horizontal","vertical"]},symbolHeight:{type:"number"},symbolWidth:{type:"number"},textStyle:{type:"object",properties:{color:{type:"string"},fontFamily:{type:"string"},fontSize:{type:"string"},fontStyle:{type:"string"},fontWeight:{type:"string"},textDecoration:{type:"string"}}},valign:{type:"string",enumValues:["top","bottom","middle"]},sectionTitleStyle:{type:"object",properties:{color:{type:"string"},fontFamily:{type:"string"},fontSize:{type:"string"},fontStyle:{type:"string"},fontWeight:{type:"string"},textDecoration:{type:"string"}}},sectionTitleHalign:{type:"string",enumValues:["center","end","start"]}},slots:{itemTemplate:{data:{}},sectionTemplate:{data:{}}},events:{ojDrill:{}},extension:{_WRITEBACK_PROPS:["hiddenCategories","highlightedCategories"],_READ_ONLY_PROPS:[],_OBSERVED_GLOBAL_PROPS:["aria-label","aria-describedby","aria-labelledby"]}},{data:null,drilling:"off",halign:"start",valign:"top",hiddenCategories:[],hideAndShowBehavior:"off",highlightedCategories:[],hoverBehavior:"none",orientation:"vertical",symbolHeight:0,symbolWidth:0,textStyle:{},sectionTitleStyle:{},sectionTitleHalign:"start"},{"@oracle/oraclejet-preact":i.default}),e.LinearLegend=y})),define("oj-c/legend",["require","exports","oj-c/legend/legend"],(function(require,e,t){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Legend=void 0,Object.defineProperty(e,"Legend",{enumerable:!0,get:function(){return t.Legend}})}));
//# sourceMappingURL=legend.js.map