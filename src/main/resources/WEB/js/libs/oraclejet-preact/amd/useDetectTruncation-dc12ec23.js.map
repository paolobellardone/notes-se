{"version":3,"file":"useDetectTruncation-dc12ec23.js","sources":["../../src/hooks/PRIVATE_useDetectTruncation/useDetectTruncation.tsx"],"sourcesContent":["import { useResizeObserver } from '#hooks/UNSAFE_useResizeObserver';\nimport { useCallback, useRef, useState } from 'preact/hooks';\n\n/**\n * Default Redwood line-height overrides cause false positives as the Range sizes are always for a 'normal'\n * line-height, and none of the default scale fonts have 'normal' line-height values. This causes offsets\n * of between 0.5px and 1.5px. As a true truncation will cause an offset of closer to a full line height\n * (at least 12px for 2xs text), use a larger offset value than the currently observed 1.5px max to reduce the likelihood of false positives.\n */\nconst verticalTruncationOffset = 5;\n\nconst useDetectTruncation = (isDisabled = false) => {\n  const rootRef = useRef<HTMLElement>(null);\n  const [isTextTruncated, setIsTextTruncated] = useState<boolean>(false);\n\n  const detectTruncation = useCallback(() => {\n    if (rootRef.current && !isDisabled) {\n      const element = rootRef.current;\n      const range = new Range();\n      range.selectNodeContents(element);\n      const untruncatedText = range.getBoundingClientRect();\n      const renderedText = element.getBoundingClientRect();\n      setIsTextTruncated(\n        untruncatedText.width > renderedText.width ||\n          untruncatedText.height > renderedText.height + verticalTruncationOffset\n      );\n    }\n  }, [isDisabled]);\n  useResizeObserver(rootRef, detectTruncation, { isDisabled: isDisabled });\n\n  const detectTruncationProps = {\n    ref: rootRef\n  };\n\n  return { detectTruncationProps, isTextTruncated };\n};\n\nexport { useDetectTruncation };\n"],"names":["isDisabled","rootRef","useRef","isTextTruncated","setIsTextTruncated","useState","detectTruncation","useCallback","current","element","range","Range","selectNodeContents","untruncatedText","getBoundingClientRect","renderedText","width","height","useResizeObserver","detectTruncationProps","ref"],"mappings":"qHAW4B,CAACA,GAAa,KACxC,MAAMC,EAAUC,SAAoB,OAC7BC,EAAiBC,GAAsBC,EAAQA,UAAU,GAE1DC,EAAmBC,EAAAA,aAAY,KACnC,GAAIN,EAAQO,UAAYR,EAAY,CAClC,MAAMS,EAAUR,EAAQO,QAClBE,EAAQ,IAAIC,MAClBD,EAAME,mBAAmBH,GACzB,MAAMI,EAAkBH,EAAMI,wBACxBC,EAAeN,EAAQK,wBAC7BV,EACES,EAAgBG,MAAQD,EAAaC,OACnCH,EAAgBI,OAASF,EAAaE,OAff,EAiB5B,IACA,CAACjB,IACJkB,EAAiBA,kBAACjB,EAASK,EAAkB,CAAEN,WAAYA,IAM3D,MAAO,CAAEmB,sBAJqB,CAC5BC,IAAKnB,GAGyBE,kBAAiB"}