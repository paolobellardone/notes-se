define("oj-c/utils/UNSAFE_keyUtils/keySetUtils",["require","exports","ojs/ojkeyset"],(function(require,e,t){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.getFirstKey=e.isEmpty=e.keysToKeySet=e.keySetToKeys=void 0;e.keySetToKeys=e=>{if(!e)return{all:!1,keys:new Set};let t={};if(e.isAddAll()){t={all:!0,deletedKeys:new Set(e.deletedValues())}}else if(!e.isAddAll()){t={all:!1,keys:new Set(e.values())}}return t};e.keysToKeySet=e=>{let r;return e.all?(r=new t.AllKeySetImpl,r=r.delete(new Set(e.deletedKeys.values()))):e.all||(r=new t.KeySetImpl(new Set(e.keys.values()))),r};e.isEmpty=e=>!e.all&&0===e.keys.size;e.getFirstKey=(e,t)=>{if(!1===e.all&&e.keys.size>0){const[t]=e.keys;return t}return t.length>0?t[0]:null}})),define("oj-c/hooks/UNSAFE_useListData/useListData",["require","exports","ojs/ojdataproviderfactory","preact/hooks"],(function(require,e,t,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.useListData=void 0;const a=Object.freeze({status:"loading",data:null}),s={isInitialFetchDeferred:!1};e.useListData=(e,t=s)=>{const l=(0,r.useRef)(null),u=(0,r.useRef)(0),d=(0,r.useRef)(!1),h=(0,r.useRef)(null),b=(0,r.useRef)(null),p=t.fetchSize&&t.fetchSize>0?t.fetchSize:25;if(!e){return[c("exact"),e=>Promise.resolve()]}const v=(0,r.useMemo)((()=>i(e)),[e]),[C,g]=(0,r.useReducer)(n,0===t.initialRowsFetched?c("atLeast"):a),w=(0,r.useCallback)((async(e,r)=>{const a={attributes:t.attributes,sortCriteria:t.sortCriteria,filterCriterion:t.filterCriterion,offset:e.offset,size:e.count},s=!0===d.current?"exact":"atLeast";if(0!==e.count)try{const t=(await v.fetchByOffset(a)).results;r&&r(t),g({status:"success",data:{offset:e.offset,data:t,totalSize:u.current,sizePrecision:s}})}catch(e){g({status:"error",error:e})}else g({status:"success",data:{offset:e.offset,data:[],totalSize:u.current,sizePrecision:s}})}),[v,t.attributes,t.filterCriterion,t.sortCriteria]),S=(0,r.useCallback)((async()=>{g({status:"loading",data:null});const e=new AbortController;b.current=e;const r=v.fetchFirst({attributes:t.attributes,sortCriteria:t.sortCriteria,filterCriterion:t.filterCriterion,size:p,signal:e.signal})[Symbol.asyncIterator]();h.current=r;try{const e=await r.next();if(r!==h.current)return;const a=e.value.fetchParameters;if(a.signal&&a.signal.aborted)return;u.current=e.value.data.length,void 0!==e.done&&(d.current=e.done);const s=t.initialRowsFetched&&t.initialRowsFetched>0?t.initialRowsFetched:p;w({offset:0,count:Math.min(u.current,s)})}catch(e){if(e instanceof DOMException&&"AbortError"===e.name)return;g({status:"error",error:e}),h.current=null}}),[v,w,t.attributes,t.filterCriterion,t.sortCriteria,t.fetchSize]),j=(0,r.useCallback)((async e=>{if(null===h.current)S();else{const t=e.offset+e.count;if(t>u.current){if(null==l.current){const r=o(h,u.current,t);l.current=r;try{const t=await r;void 0!==t.done&&(d.current=t.done);const a=t.total;(a>0||0===a&&d.current)&&(u.current=a,w({offset:e.offset,count:Math.min(u.current-e.offset,e.count)})),l.current=null}catch(e){g({status:"error",error:e}),l.current=null}}}else w(e)}}),[C,S,w]),x=(0,r.useCallback)((()=>{h.current=null,l.current=null,u.current=0,d.current=!1,0===t.initialRowsFetched?g(c("atLeast")):t.isInitialFetchDeferred?g({status:"loading",data:null}):S()}),[S,t.isInitialFetchDeferred,t.initialRowsFetched]);(0,r.useEffect)((()=>{x()}),[x]);const k=(0,r.useCallback)((e=>{if("success"===C.status&&C.data){const r=C.data;let a,s=r.data.length,i=!1;if(e.detail.add){const a=f(e.detail.add,r,t,!0);u.current=u.current+a,s+=a,i=a>0||"exact"===r.sizePrecision,0===a&&(d.current=!1)}if(e.detail.remove){const a=f(e.detail.remove,r,t,!1);u.current=Math.max(0,u.current-a),s=Math.max(0,s-a),i=i||a>0}const n=e.detail.update;n&&(i=i||y(n,r,t),a=e=>{m(n,r,e)}),i&&w({offset:r.offset,count:s},a)}}),[C,t,w]),P=(0,r.useCallback)((e=>{let t=-1;const r=e.detail?.disregardAfterKey;if(r&&"success"===C.status){const e=C.data.data.findIndex((e=>e.metadata.key===r));if(e>-1&&(t=C.data.data.length-e-1),0===t&&C.data.data.length>=p)return}t>-1&&"success"===C.status?(u.current=u.current-t,j({offset:C.data.offset,count:Math.max(C.data.data.length,p)})):("loading"===C.status&&b.current?.abort(),x())}),[C,x]);return(0,r.useEffect)((()=>(v.addEventListener("refresh",P),v.addEventListener("mutate",k),()=>{v.removeEventListener("refresh",P),v.removeEventListener("mutate",k)})),[v,x,k]),[C,j]};const i=e=>(0,t.getEnhancedDataProvider)(e,{fetchFirst:{caching:"visitedByCurrentIterator"}}),n=(e,t)=>e.status===t.status&&"loading"===t.status?e:t,o=async(e,t,r)=>await l(e,t,r),l=async(e,t,r)=>{const a=e.current;if(null===a)return{total:-1,done:void 0};const s=await a.next();return a===e.current?(t+=s.value.data.length)>=r||s.done?{total:t,done:s.done}:l(e,t,r):{total:-1,done:void 0}},c=e=>"atLeast"===e?u:d,u=Object.freeze({status:"success",data:{offset:0,data:[],totalSize:0,sizePrecision:"atLeast"}}),d=Object.freeze({status:"success",data:{offset:0,data:[],totalSize:0,sizePrecision:"exact"}}),f=(e,t,r,a)=>{let s=0;if(h(e,r)){const r=a?e.indexes?.sort(((e,t)=>e-t)):e.indexes;let i=t.totalSize-1;r?.forEach((e=>{e<=i&&(s=s+=1,a&&(i=i+=1))}))}return s},y=(e,t,r)=>{if(h(e,r)){const r=e.indexes?e.indexes:[],a=t.offset,s=a+t.data.length;for(let e=0;e<r.length;e++)if(r[e]>=a&&r[e]<s)return!0}return!1},m=(e,t,r)=>{e.keys.forEach((e=>{const a=r.find((t=>t.metadata.key==e)),s=t.data.find((t=>t.metadata.key==e));s&&a&&s.data===a.data&&(a.data=new Proxy(a.data,{}))}))},h=(e,t)=>e.indexes&&null==t.sortCriteria&&null==t.filterCriterion})),define("oj-c/card-view/useCardViewPreact",["require","exports","preact/hooks","../utils/UNSAFE_keyUtils/keySetUtils","../hooks/UNSAFE_useListData/useListData"],(function(require,e,t,r,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.useCardViewPreact=void 0;e.useCardViewPreact=({"aria-label":e,"aria-labelledby":s,data:i,gutterSize:n,focusBehavior:o,onCurrentItemChanged:l,selected:c,onSelectedChanged:u,scrollPolicyOptions:d,selectionMode:f,initialAnimation:y,columns:m,reorderable:h,onOjReorder:b},p,v)=>{const C=(0,t.useRef)(),[g,w]=(0,a.useListData)(i,{fetchSize:d?.fetchSize}),S=(0,r.keySetToKeys)(c),j="error"!==g.status?g.data:null,[x,k]=(0,t.useState)(),P=Number.isInteger(m)?m:void 0;(0,t.useEffect)((()=>{"loading"===g.status?C.current=p("list data is in fetch state"):C.current&&(C.current(),C.current=void 0)}),[g.status]);const z=d?.scroller?{scroller:()=>d.scroller?document.querySelector(d.scroller):null}:void 0,E=(0,t.useCallback)((()=>{if(j){const e=d&&d.fetchSize?d.fetchSize:25;w({offset:0,count:j.data.length+e})}}),[g,d,w]);return{status:g.status,cardViewProps:{"aria-label":e,"aria-labelledby":s,data:j?j.data:null,currentKey:x,getRowKey:e=>e.metadata.key,gutterSize:n,onCurrentKeyChange:e=>{k(e.value),l&&l(e.value)},hasMore:!!j&&"atLeast"===j.sizePrecision,onLoadMore:E,focusBehavior:o,onSelectionChange:e=>{u&&!v(e.target)&&u((0,r.keysToKeySet)(e.value))},selectedKeys:S,selectionMode:f,initialAnimation:y,columns:P,viewportConfig:z,onReorder:"enabled"===h?.items?e=>{b&&b(e)}:null}}}})),define("oj-c/card-view/cardViewItem",["require","exports","preact/jsx-runtime","@oracle/oraclejet-preact/hooks/UNSAFE_useTabbableMode"],(function(require,e,t,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.CardViewItem=void 0;e.CardViewItem=({context:e,itemTemplate:a})=>{const{isTabbable:s}=(0,r.useTabbableMode)(),i={isTabbable:s,data:e.data.data,item:e.data};return(0,t.jsx)(r.TabbableModeContext.Provider,{value:{isTabbable:s},children:a&&a(i)})}})),define("oj-c/card-view/card-view",["require","exports","preact/jsx-runtime","@oracle/oraclejet-preact/translationBundle","ojs/ojcontext","preact/hooks","ojs/ojvcomponent","preact/compat","@oracle/oraclejet-preact/UNSAFE_CardFlexView","@oracle/oraclejet-preact/UNSAFE_CardGridView","./useCardViewPreact","./cardViewItem","@oracle/oraclejet-preact/hooks/UNSAFE_useTranslationBundle","@oracle/oraclejet-preact/UNSAFE_EmptyList","css!oj-c/card-view/card-view-styles.css"],(function(require,e,t,r,a,s,i,n,o,l,c,u,d,f){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.CardView=void 0;const y=({addBusyState:e,isClickthroughDisabled:r,itemTemplate:a,noData:i,...y})=>{const{status:m,cardViewProps:h}=(0,c.useCardViewPreact)(y,e,r),b=(0,d.useTranslationBundle)("@oracle/oraclejet-preact");if("success"===m&&!h.hasMore&&0===h.data?.length){if(i)return(0,t.jsx)(f.EmptyList,{children:i(n.Children)});{const e=b.noData_message();return(0,t.jsx)(f.EmptyList,{children:e})}}return h.columns?(0,t.jsx)(l.CardGridView,{...h,children:(0,s.useCallback)((e=>(0,t.jsx)(u.CardViewItem,{context:e,itemTemplate:a})),[a])}):(0,t.jsx)(o.CardFlexView,{...h,children:e=>(0,t.jsx)(u.CardViewItem,{context:e,itemTemplate:a})})};e.CardView=(0,i.registerCustomElement)("oj-c-card-view",(({columns:e="auto",data:r=null,focusBehavior:n="card",gutterSize:o="sm",initialAnimation:l="slideUp",scrollPolicyOptions:c={fetchSize:25},selectionMode:u="none",reorderable:d={items:"disabled"},...f})=>{const h=(0,s.useRef)(),b=(0,s.useRef)(a.getContext(h.current).getBusyContext()),p=(0,s.useCallback)((e=>null!==e&&void 0!==h.current&&m({target:e},h.current)),[]),v=(0,s.useCallback)((e=>b.current?.addBusyState({description:`oj-c-card-view: ${e}`})),[]),C={columns:e,data:r,focusBehavior:n,gutterSize:o,initialAnimation:l,scrollPolicyOptions:c,selectionMode:u,reorderable:d,...f};return(0,t.jsx)(i.Root,{id:C.id,ref:h,children:(0,t.jsx)(y,{addBusyState:v,isClickthroughDisabled:p,...C})})}),"CardView",{properties:{currentItem:{type:"any",readOnly:!0,writeback:!0},data:{type:"DataProvider|null"},gutterSize:{type:"string",enumValues:["xs","sm","md","lg","xl"]},scrollPolicyOptions:{type:"object",properties:{fetchSize:{type:"number"},scroller:{type:"string"}}},selected:{type:"object",writeback:!0},selectionMode:{type:"string",enumValues:["none","multiple","single"]},initialAnimation:{type:"string",enumValues:["slideUp","slideDown"]},focusBehavior:{type:"string",enumValues:["content","card"]},columns:{type:"number|string"},reorderable:{type:"object",properties:{items:{type:"string",enumValues:["disabled","enabled"]}}}},slots:{noData:{data:{}},itemTemplate:{data:{}}},events:{ojReorder:{}},extension:{_WRITEBACK_PROPS:["currentItem","selected"],_READ_ONLY_PROPS:["currentItem"],_OBSERVED_GLOBAL_PROPS:["aria-label","aria-labelledby","id"]}},{columns:"auto",data:null,focusBehavior:"card",gutterSize:"sm",initialAnimation:"slideUp",scrollPolicyOptions:{fetchSize:25},selectionMode:"none",reorderable:{items:"disabled"}},{"@oracle/oraclejet-preact":r.default});const m=function(e,t){let r=e.target;for(;null!=r&&r!==t;){if(h(r))return!0;r=r.parentNode}return!1},h=function(e){return"disabled"===e.dataset.ojClickthrough}})),define("oj-c/card-view",["require","exports","oj-c/card-view/card-view"],(function(require,e,t){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.CardView=void 0,Object.defineProperty(e,"CardView",{enumerable:!0,get:function(){return t.CardView}})}));
//# sourceMappingURL=card-view.js.map