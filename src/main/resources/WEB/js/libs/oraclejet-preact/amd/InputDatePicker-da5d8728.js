define(['exports', 'preact/jsx-runtime', 'preact/compat', 'preact/hooks', './Calendar-d1c38937', './HiddenAccessible-037ef42d', './IconButton-1b328b69', './clientHints-030d25aa', './FormFieldContext-3c44aaaa', './logger-0f873e29', './TabbableModeContext-a9c97640', './useTranslationBundle-20bfc0f3', 'css!./UserAssistanceStyles.styles.css', 'module', './UNSAFE_UserAssistance/themes/redwood/UserAssistanceVariants.css', './InlineUserAssistance-f4d1fa1b', './Flex-db3ddadb', 'css!./MessageBannerStyles.styles.css', 'module', './UNSAFE_MessageBanner/themes/redwood/MessageBannerVariants.css', 'preact', './useTooltipControlled-18271c7a', 'css!./IconStyle.styles.css', 'css!./MessageStyles.styles.css', './MessageFormattingUtils-2e19d8de', './LayerHost-0a244de8', './TransitionGroup-3b9d81b6', './MessagesContext-602a69a2', 'css!./HiddenAccessibleStyles.styles.css', 'css!./ComponentMessageStyles.styles.css', 'module', './UNSAFE_ComponentMessage/themes/redwood/ComponentMessageVariants.css', './Popup-b5495d55', './UNSAFE_Separator/themes/SeparatorStyles.css', 'css!./LabelStyles.styles.css', 'module', './UNSAFE_Label/themes/redwood/LabelVariants.css', './InputGroupContext-372087af', 'module', './UNSAFE_Popup/themes/redwood/PopupVariants.css', './UNSAFE_InputDatePicker/themes/InputDatePickerDropdownStyles.css', './Sheet-a398d015', './UNSAFE_DatePicker/themes/DatePickerContract.css', './DatePicker-70b1aba4', './SectionedContent-d896b84f', './stringUtils-0ae982c2', './FormContext-5130e198', './useFormContext-30acdd33', './useId-c9578d26', './getFormatParse-b7ff0219', './maskUtils-86dd685a', './calendarDateUtils-1f56aaf5', './InputDateMask-b7a27faa'], (function(e,t,s,a,n,r,o,i,d,l,c,u,m,p,h,f,y,b,C,D,S,x,A,k,v,g,F,V,I,T,P,R,M,U,w,j,_,B,H,E,N,L,O,W,Y,Z,z,G,q,J,K,Q,X){"use strict";const $=({anchorRef:e,assistiveText:s,dayFormatter:n,daysOutsideMonth:r,helpSourceLink:o,helpSourceText:i,isDisabled:l,isOpen:c,isReadonly:m,label:p,onClose:h,onCommit:y,max:b,messages:C,min:D,monthAndYearPicker:S,testId:x,todayButton:A,todayTimeZone:k,userAssistanceDensity:v,value:g})=>{const[F,V]=a.useState(!1),[I,T]=a.useState(c),P=a.useCallback((e=>{V(e.placement.startsWith("top"))}),[]);I!==c&&(T(c),c||V(!1));const R=ee(),{datePicker_label:M}=u.useTranslationBundle("@oracle/oraclejet-preact"),U=M(),w=t.jsx(W.DatePicker,{dayFormatter:n,daysOutsideMonth:r,onCommit:y,max:b,min:D,maxWidth:R?"100%":void 0,width:R?"100%":O.datePickerPropVars.maxWidth,monthAndYearPicker:S,testId:x,todayTimeZone:k,todayButton:A,value:g}),j=!c||F&&!R||l||m||!(s||o||C&&C.length>0)||"efficient"!==v&&"reflow"!==v?void 0:t.jsx(d.FormFieldContext.Provider,{value:{isFocused:!0},children:t.jsx("div",{class:N.userAssistanceStyles,children:t.jsx(f.InlineUserAssistance,{assistiveText:s,fieldLabel:p,helpSourceLink:o,helpSourceText:i,messages:C,userAssistanceDensity:v})})}),_=x?x+(R?"_sheet":"_dropdown"):void 0,B=t.jsx("div",{class:N.dropdownStyles,children:t.jsx(Y.SectionedContent,{"aria-label":U,footer:j,hasFocusTrap:!0,main:w,role:"dialog",testId:_})});return R?t.jsx(L.Sheet,{initialFocus:"firstFocusable",isOpen:c,onClose:h,children:t.jsx(Y.SectionedContent,{"aria-label":U,footer:j,hasFocusTrap:!0,main:w,role:"dialog",testId:_})}):t.jsx(Y.StickyPositioningDropdown,{anchorRef:e,initialFocus:"firstFocusable",isOpen:c,onClose:h,onPosition:P,sizeOptions:{isMaxWidthAdjusted:!1,isMaxHeightAdjusted:!0},children:B})},ee=()=>"phone"===i.getClientHints().deviceType,te=e=>e&&Q.isCompleteCalendarDate(e)?e:void 0,se=(e,t)=>{switch(t.type){case"dateChanged":return{...e,dateValue:t.data,completeDateValue:te(t.data)};case"dateSelected":return{...e,dateValue:t.data,completeDateValue:t.data};case"reset":return{completeDateValue:te(t.data),dateValue:t.data};default:return e}},ae=({onCommit:e,onInput:t,value:s})=>{const[n,r]=a.useState(!1),o=a.useRef(null),i=a.useRef(null),d=a.useRef(!1),l=a.useRef(),c=a.useRef(!1),u=a.useRef(),m=a.useRef(s),p=a.useRef(s),h=a.useRef(s),f=a.useRef(!1),{state:y,dispatch:b}=(({value:e})=>{const[t,s]=a.useReducer(se,{completeDateValue:te(e),dateValue:e});return{state:t,dispatch:s}})({value:s});K.calendarDatesAreDifferent(h.current,s)&&(h.current=s,K.calendarDatesAreDifferent(s,y.dateValue)&&(b({type:"reset",data:s}),p.current=s,m.current=s)),a.useEffect((()=>{K.calendarDatesAreDifferent(y.dateValue,p.current)&&(t({previousValue:p.current,value:y.dateValue}),p.current=y.dateValue),f.current&&K.calendarDatesAreDifferent(y.dateValue,m.current)&&(e?.({previousValue:m.current,value:y.dateValue}),m.current=y.dateValue,f.current=!1)}),[e,t,y.dateValue]);const C=a.useCallback((e=>{b({type:"dateChanged",data:e.value})}),[b]),D=a.useCallback((()=>{K.calendarDatesAreDifferent(m.current,y.dateValue)&&(e?.({value:y.dateValue,previousValue:m.current}),m.current=y.dateValue)}),[e,y.dateValue]),S=a.useCallback((()=>{d.current||c.current||r((e=>!e)),d.current=!1,c.current=!1}),[]),x=a.useCallback((e=>{"outsideMousedown"===e.reason?(d.current=!0,clearTimeout(l.current),l.current=setTimeout((()=>{d.current=!1}),200)):"dismissed"!==e.reason&&"keyboardDismissed"!==e.reason||o.current?.focus(),r(!1)}),[]);return{calendarIconActionHandler:S,datePickerCommitHandler:a.useCallback((e=>{o.current?.focus(),c.current=!0,clearTimeout(u.current),u.current=setTimeout((()=>{c.current=!1}),500),f.current=!0,b({type:"dateSelected",data:e.value}),r(!1)}),[b]),dropdownCloseHandler:x,completeDateValue:y.completeDateValue,dateValue:y.dateValue,iconRef:o,isOpen:n,maskCommitHandler:D,maskInputHandler:C,maskRef:i}},ne=s.forwardRef((({"aria-describedby":e,assistiveText:s,dayFormatter:i,daysOutsideMonth:d,helpSourceLink:l,helpSourceText:c,isDisabled:m,isReadonly:p,label:h,max:f,messages:y,min:b,monthAndYearPicker:C,todayTimeZone:D,todayButton:S,value:x,onCommit:A,onInput:k,testId:v,userAssistanceDensity:g,...F},V)=>{const{calendarIconActionHandler:I,datePickerCommitHandler:T,completeDateValue:P,dateValue:R,dropdownCloseHandler:M,iconRef:U,isOpen:w,maskCommitHandler:j,maskInputHandler:_,maskRef:B}=ae({onCommit:A,onInput:k,value:x}),H=a.useRef(null),{inputDatePicker_selectDate:E,inputDatePicker_instruction:N}=u.useTranslationBundle("@oracle/oraclejet-preact"),L=E(),{userAssistanceDensity:O}=G.useFormContext(),W=g??O;a.useImperativeHandle(V,(()=>({focus:()=>{B.current?.focus()},blur:()=>{B.current?.blur()}})));const Y=q.useId(),z=N(),J=m||p?void 0:t.jsx(r.HiddenAccessible,{id:Y,isHidden:!0,children:z}),K=m||p?e:Z.merge([e,Y]),Q=t.jsx(o.IconButton,{"aria-haspopup":"dialog","aria-label":L,isDisabled:m,ref:U,size:"sm",testId:v?v+"_calendarIcon":void 0,variant:"ghost",onAction:I,children:t.jsx(n.SvgCalendar,{})}),ee=w;return t.jsxs(t.Fragment,{children:[t.jsx(X.InputDateMaskContext.Provider,{value:{isDropdownOpen:w,isInputDatePickerParent:!0},children:t.jsx(X.InputDateMask,{"aria-describedby":K,assistiveText:s,endContent:Q,helpSourceLink:l,helpSourceText:c,isDisabled:m,isReadonly:p,label:h,onCommit:j,onInput:_,mainFieldRef:H,messages:y,testId:v,ref:B,userAssistanceDensity:g,value:R,...F})}),J,ee&&t.jsx($,{anchorRef:H,assistiveText:s,dayFormatter:i,daysOutsideMonth:d,helpSourceLink:l,helpSourceText:c,isDisabled:m,isReadonly:p,isOpen:w,label:h,onClose:M,onCommit:T,max:f,messages:y,min:b,monthAndYearPicker:C,testId:v?v+"_datePicker":void 0,todayTimeZone:D,todayButton:S,userAssistanceDensity:W,value:P})]})}));e.InputDatePicker=ne}));
//# sourceMappingURL=InputDatePicker-da5d8728.js.map
